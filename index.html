<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fish Auditory EEG Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Encode+Sans+Condensed:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100">
    <nav class="menu-bar bg-white border-b border-slate-200 px-6 py-4 flex gap-6">
      <a href="index.html" class="font-semibold" style="color:#32006e">Home</a>
      <a href="overview.html" class="text-slate-700">Overview</a>
      <a href="pipeline.html" class="text-slate-700">Analysis Pipeline</a>
      <a href="visuals.html" class="text-slate-700">Visual Summaries</a>
      <a href="team.html" class="text-slate-700">Team & Course</a>
    </nav>
    <main class="max-w-2xl mx-auto py-16 px-4 text-center">
      <img src="ratfish_animation.gif" alt="Spotted ratfish animation" class="mx-auto h-32 w-32 object-contain mb-6" />
      <h1 class="text-3xl font-bold mb-4">Welcome to the Fish Auditory EEG Dashboard</h1>
      <p class="text-lg text-slate-700 mb-8">Explore our project sections using the menu above.</p>
      <div class="grid gap-6 md:grid-cols-2 mt-8">
        <a href="overview.html" class="block rounded-xl border border-slate-200 bg-white p-6 shadow-sm hover:shadow-md transition">
          <h2 class="text-xl font-semibold mb-2" style="color:#32006e">Project Overview</h2>
          <p class="text-slate-600">Background, goals, and key parameters of the auditory EEG analysis pipeline.</p>
        </a>
        <a href="pipeline.html" class="block rounded-xl border border-slate-200 bg-white p-6 shadow-sm hover:shadow-md transition">
          <h2 class="text-xl font-semibold mb-2" style="color:#32006e">Analysis Pipeline</h2>
          <p class="text-slate-600">Step-by-step breakdown of the data processing and analysis workflow.</p>
        </a>
        <a href="visuals.html" class="block rounded-xl border border-slate-200 bg-white p-6 shadow-sm hover:shadow-md transition">
          <h2 class="text-xl font-semibold mb-2" style="color:#32006e">Visual Summaries</h2>
          <p class="text-slate-600">Interactive charts and summary statistics from the analysis results.</p>
        </a>
        <a href="team.html" class="block rounded-xl border border-slate-200 bg-white p-6 shadow-sm hover:shadow-md transition">
          <h2 class="text-xl font-semibold mb-2" style="color:#32006e">Team & Course</h2>
          <p class="text-slate-600">Meet the project team and see course information and acknowledgments.</p>
        </a>
      </div>
      <div class="mt-10">
        <p class="text-sm text-slate-500">&copy; 2025 Fish Auditory EEG Dashboard. Data citation: Hunsaker, A., Brown, A., Sisneros, J., James, M., Tritt, C., Sonthalia, Y. (2025). Fish Auditory EEG Analysis Dataset. University of Washington. <a href="https://github.com/aoih-uw/fish_eeg" class="underline" style="color:#32006e" target="_blank" rel="noopener">https://github.com/aoih-uw/fish_eeg</a></p>
        <p class="text-sm text-slate-700 mt-2">Thank you to the Spotted Ratfish</p>
      </div>
    </main>

    <script>
        // Simple tab switching
        const triggers = document.querySelectorAll('.tab-trigger');
        const panels = document.querySelectorAll('.tab-panel');
        triggers.forEach(btn => {
            btn.addEventListener('click', () => {
                triggers.forEach(b => b.setAttribute('aria-selected', 'false'));
                panels.forEach(p => p.classList.add('hidden'));
                btn.setAttribute('aria-selected', 'true');
                const target = document.getElementById(btn.dataset.target);
                if (target) target.classList.remove('hidden');
            });
        });

        // Subject selection placeholder logic (extend with dynamic charts later)
        const subjectSelect = document.getElementById('subjectSelect');
        const iframeAll = document.getElementById('iframeAll');
        const iframeMedian = document.getElementById('iframeMedian');
        const iframeIca = document.getElementById('iframeIca');
        const SUBJECT_BASE_PATHS = [
            // Ordered guesses for where subject-specific plots may live.
            // Adjust or extend these patterns as files become available.
            (s) => `analysis/plots/${s}/95CI_all.html`,
            (s) => `analysis/plots/${s}/95CI_median.html`,
            (s) => `analysis/plots/${s}/ICAweights.html`,
            // Fallback to summary_plots if specific not found
        ];
        const AGGREGATE_PATHS = {
            all: {
                all: 'analysis/plots/summary_plots/95CI_all.html',
                median: 'analysis/plots/summary_plots/95CI_median.html',
                ica: 'analysis/plots/summary_plots/ICAweights.html'
            }
        };

        async function probe(url) {
            try {
                const res = await fetch(url, { method: 'HEAD' });
                return res.ok;
            } catch { return false; }
        }

        async function setSubjectCharts(subj) {
            if (subj === 'all') {
                iframeAll.src = AGGREGATE_PATHS.all.all;
                iframeMedian.src = AGGREGATE_PATHS.all.median;
                iframeIca.src = AGGREGATE_PATHS.all.ica;
                return;
            }
            // Attempt subject-specific paths; graceful fallback.
            const specificAll = `analysis/plots/${subj}/95CI_all.html`;
            const specificMedian = `analysis/plots/${subj}/95CI_median.html`;
            const specificIca = `analysis/plots/${subj}/ICAweights.html`;
            iframeAll.src = (await probe(specificAll)) ? specificAll : AGGREGATE_PATHS.all.all;
            iframeMedian.src = (await probe(specificMedian)) ? specificMedian : AGGREGATE_PATHS.all.median;
            iframeIca.src = (await probe(specificIca)) ? specificIca : AGGREGATE_PATHS.all.ica;
        }
        subjectSelect.addEventListener('change', () => {
            const val = subjectSelect.value;
            setSubjectCharts(val);
        });

        // Pipeline collapse toggle
        const pipelineToggle = document.getElementById('pipelineToggle');
        const pipelinePanels = document.getElementById('pipelinePanels');
        let pipelineCollapsed = false;
        pipelineToggle.addEventListener('click', () => {
            pipelineCollapsed = !pipelineCollapsed;
            pipelinePanels.querySelectorAll('details').forEach(d => {
                if (pipelineCollapsed) { d.removeAttribute('open'); }
                else { d.setAttribute('open', ''); }
            });
            pipelineToggle.textContent = pipelineCollapsed ? 'Expand All' : 'Collapse';
        });

        // Initial subject setting
        setSubjectCharts(subjectSelect.value);
    </script>
    <style>
    /* Print-friendly adjustments */
    @media print {
      #themeToggle, #pipelineToggle, .tab-trigger, header, footer, #subjectSelect, .rounded-lg.border.border-slate-200.bg-white.p-3.flex.flex-col, .text-xs.text-slate-500.mb-4 { display: none !important; }
      #visualSummaryContainer { margin: 0 !important; padding: 0 !important; box-shadow: none !important; background: white !important; }
      iframe { height: 380px !important; }
      body { background: white !important; }
    }
    </style>
</body>
</html>